---
title: "Registry endpoints"
description: "Publish, list, and inspect SPECTER announcements in the in-memory registry"
---

<CardGroup cols={3}>
  <Card title="Publish" icon="megaphone">
    `POST /api/v1/registry/announcements` validates and stores new announcements.
  </Card>
  <Card title="List" icon="list">
    `GET /api/v1/registry/announcements` returns paginated announcements with filters.
  </Card>
  <Card title="Stats" icon="chart-simple">
    `GET /api/v1/registry/stats` returns total count and non-zero view-tag distribution.
  </Card>
</CardGroup>

## `POST /api/v1/registry/announcements`

### Request schema

<ParamField body="ephemeral_key" type="string" required>
Hex-encoded ephemeral ciphertext.
</ParamField>
<ParamField body="view_tag" type="integer" required>
Announcement view tag (`0-255`).
</ParamField>
<ParamField body="tx_hash" type="string" required>
Transaction hash string. Must be non-empty.
</ParamField>
<ParamField body="channel_id" type="string">
Optional 32-byte channel id as 64 hex characters.
</ParamField>
<ParamField body="amount" type="string">
Optional human-readable amount string.
</ParamField>
<ParamField body="chain" type="string">
Optional chain identifier (for example `ethereum`, `sui`).
</ParamField>

### Response schema

<ParamField body="id" type="integer" required>
Assigned registry announcement id.
</ParamField>
<ParamField body="success" type="boolean" required>
Publish confirmation.
</ParamField>

## `GET /api/v1/registry/announcements`

### Query parameters

<ParamField query="view_tag" type="integer">
Filter announcements by a specific view tag.
</ParamField>
<ParamField query="from_timestamp" type="integer">
Start of time-range filter (Unix timestamp).
</ParamField>
<ParamField query="to_timestamp" type="integer">
End of time-range filter (Unix timestamp).
</ParamField>
<ParamField query="offset" type="integer" default={0}>
Pagination offset.
</ParamField>
<ParamField query="limit" type="integer" default={100}>
Pagination limit.
</ParamField>

### Response schema

<ParamField body="announcements" type="array" required>
Paginated announcement rows.
</ParamField>
<ParamField body="total" type="integer" required>
Total matching rows before pagination.
</ParamField>

## `GET /api/v1/registry/stats`

### Response schema

<ParamField body="total_announcements" type="integer" required>
Current total number of stored announcements.
</ParamField>
<ParamField body="view_tag_distribution" type="array" required>
Array of non-zero tag buckets (`tag`, `count`).
</ParamField>

## Example calls

<Tabs>
  <Tab title="Publish (cURL)">

```bash
curl -s -X POST http://localhost:3001/api/v1/registry/announcements \
  -H "Content-Type: application/json" \
  -d '{
    "ephemeral_key":"<HEX_CIPHERTEXT>",
    "view_tag":42,
    "tx_hash":"0xabc123...",
    "chain":"ethereum",
    "amount":"0.10"
  }' | jq .
```

  </Tab>
  <Tab title="List (cURL)">

```bash
curl -s "http://localhost:3001/api/v1/registry/announcements?view_tag=42&offset=0&limit=20" | jq .
```

  </Tab>
  <Tab title="Stats (cURL)">

```bash
curl -s "http://localhost:3001/api/v1/registry/stats" | jq .
```

  </Tab>
</Tabs>

## Behavior notes

<AccordionGroup>
  <Accordion title="Duplicate transaction hashes are rejected">
    The in-memory registry normalizes `tx_hash` and prevents duplicate entries with the same transaction hash.
  </Accordion>
  <Accordion title="List filter precedence">
    Listing uses `view_tag` when present. If absent, it uses time range only when both `from_timestamp` and `to_timestamp` are provided. Otherwise it returns all.
  </Accordion>
  <Accordion title="Storage scope">
    API state uses `MemoryRegistry`, so announcements are process-local and reset when the process restarts.
  </Accordion>
</AccordionGroup>

## Source references

- `../SPECTER/specter/specter-api/src/handlers.rs`
- `../SPECTER/specter/specter-api/src/dto.rs`
- `../SPECTER/specter/specter-registry/src/memory.rs`
